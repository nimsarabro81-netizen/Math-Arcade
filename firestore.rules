/**
 * @file Firestore Security Rules for VectorZen app.
 *
 * @core_philosophy This ruleset allows public read access to all ranking data, but restricts write access.
 * This approach prioritizes allowing application users to view the rankings, while unauthorized edits are disallowed.
 *
 * @data_structure The data is organized into three top-level collections: `/userRanks`, `/algebraRanks`, and `/equationRanks`.
 *  Each collection stores user ranking data for a specific game.
 *
 * @key_security_decisions
 *   - Public read access is granted to all ranking collections.
 *   - All write access is denied.
 *   - Listing is allowed, given this is a score ranking use case.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to the `/userRanks` collection, but denies all write access.
     * @path /databases/{database}/documents/userRanks
     * @allow (get, list) Any user can read the documents in this collection.
     * @deny (create, update, delete) No user can create, update, or delete documents in this collection.
     * @principle Allows any user to see the leaderboard, but restricts unauthorized edits.
     */
    match /userRanks/{userRankId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows public read access to the `/algebraRanks` collection, but denies all write access.
     * @path /databases/{database}/documents/algebraRanks
     * @allow (get, list) Any user can read the documents in this collection.
     * @deny (create, update, delete) No user can create, update, or delete documents in this collection.
     * @principle Allows any user to see the leaderboard, but restricts unauthorized edits.
     */
    match /algebraRanks/{algebraRankId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows public read access to the `/equationRanks` collection, but denies all write access.
     * @path /databases/{database}/documents/equationRanks
     * @allow (get, list) Any user can read the documents in this collection.
     * @deny (create, update, delete) No user can create, update, or delete documents in this collection.
     * @principle Allows any user to see the leaderboard, but restricts unauthorized edits.
     */
    match /equationRanks/{equationRankId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }
  }
}